<div fxLayout fxLayoutAlign="center">
  <div fxFlex.gt-xs="80%" fxFlex.xs="90%" fxLayout fxLayout.xs="column" fxLayoutGap="20px" *ngIf="tutorial">
    <div fxFlex.gt-xs="75%">
      <h1 *ngIf="isNew">Nuovo Tutorial</h1>
      <h1 *ngIf="!isNew">Modifica Tutorial <mat-icon *ngIf="updated" style="color:green">done_outline</mat-icon>
      </h1>
      <div fxLayout="column" fxLayoutGap="20px">
        <mat-form-field>
          <input matInput length="120" placeholder="Titolo" [(ngModel)]="tutorial.title">
        </mat-form-field>
      </div>
      <div *ngIf="!isNew">
        <h3 *ngIf="tutorial.pages.length >0">Pagine</h3>

        <mat-table [dataSource]="tutorial.pages" class="mat-elevation-z4">

          <ng-container matColumnDef="title">
            <mat-cell *matCellDef="let page">
              {{page.title}}
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="edit">
            <mat-cell *matCellDef="let page">
              <button mat-icon-button>
                <i class="fa fa-edit"></i>
              </button>
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="delete">
            <mat-cell *matCellDef="let page">
              <button mat-icon-button (click)="removePage(page.id)">
                <i class="fa fa-times-circle"></i>
              </button>
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="up">
            <mat-cell *matCellDef="let page">
              <button mat-icon-button (click)="movePage(page.id,-1)" *ngIf="page.indexInTutorial > 0">
                <i class="fa fa-arrow-circle-up"></i>
              </button>
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="down">
            <mat-cell *matCellDef="let page">
              <button mat-icon-button (click)="movePage(page.id,1)" *ngIf="page.indexInTutorial < (tutorial.pages.length-1)">
                <i class="fa fa-arrow-circle-down"></i>
              </button>
            </mat-cell>
          </ng-container>

          <mat-row fxFlexAlign="center" *matRowDef="let row; columns: displayedColumns"></mat-row>
        </mat-table>


        <mat-form-field class="page">
          <input matInput length="120" placeholder="Nuova pagina" [(ngModel)]="newPageTitle">
        </mat-form-field>
        <button mat-button (click)="addPage()">
          <i class="fa fa-plus-circle" style="margin-right:5px"> </i><span fxHide.xs>Aggiungi</span>
        </button>

      </div>

      <h2>Azioni</h2>
      <div>
        <button mat-raised-button *ngIf="isNew" (click)="createTutorial()" style="background-color:rgb(52, 156, 57);">Crea</button>
        <button mat-raised-button *ngIf="!isNew" (click)="updateTutorial()" color="accent">Aggiorna</button>
        <button mat-raised-button color="warn" (click)="deleteTutorial()">Elimina</button>
        <button mat-raised-button *ngIf="!isNew && !isPublic" (click)="publishTutorial()" style="background-color:rgb(52, 156, 57);">Pubblica</button>
        <button mat-raised-button *ngIf="isPublic" (click)="unpublishTutorial()" style="background-color:rgb(223, 169, 69);">Nascondi</button>
      </div>

    </div>
    <div fxFlex.gt-xs="25%">
      <div fxLayout="column">
        <h2>Stato tutorial</h2>
        <span *ngIf="isNew">Nuovo</span>
        <span *ngIf="!isNew && isPublic">Tutorial pubblicato</span>
        <span *ngIf="!isNew && !isPublic">Tutorial nascosto</span>
        <span *ngIf="isPublic ">Creato da:</span>
        <span *ngIf="isPublic ">Creazione tutorial: </span>
        <span *ngIf="isPublic "></span>
        <span *ngIf="!isNew ">Ultima modifica: {{ tutorial.updateDate }}</span>
      </div>
      <div fxLayout="column" *ngIf="authSVC.authUser && authSVC.authUser.canEditArticles()">
        <h2>Gestione Tutorial</h2>
        <button mat-button style="text-align: left" routerLink="../" *ngIf="!isNew">
          <mat-icon>open_in_browser</mat-icon> Visualizza tutorial
        </button>
        <button mat-button style="text-align: left" routerLink="/tutorial/new">
          <mat-icon>add_box</mat-icon> Nuovo tutorial
        </button>
        <button mat-button style="text-align: left" routerLink="/tutorial/admin">
          <mat-icon>format_list_bulleted</mat-icon> Gestisci tutorial
        </button>
      </div>
    </div>
  </div>
</div>